const v=(()=>{if(typeof self>"u")return!1;if("top"in self&&self!==top)try{}catch{return!1}return"showOpenFilePicker"in self})(),b=v?Promise.resolve().then(function(){return A}):Promise.resolve().then(function(){return T});async function U(...e){return(await b).default(...e)}const P=v?Promise.resolve().then(function(){return O}):Promise.resolve().then(function(){return R});async function M(...e){return(await P).default(...e)}const g=v?Promise.resolve().then(function(){return x}):Promise.resolve().then(function(){return F});async function N(...e){return(await g).default(...e)}const k=async e=>{const n=await e.getFile();return n.handle=e,n};var _=async(e=[{}])=>{Array.isArray(e)||(e=[e]);const n=[];e.forEach((o,a)=>{n[a]={description:o.description||"Files",accept:{}},o.mimeTypes?o.mimeTypes.map(i=>{n[a].accept[i]=o.extensions||[]}):n[a].accept["*/*"]=o.extensions||[]});const r=await window.showOpenFilePicker({id:e[0].id,startIn:e[0].startIn,types:n,multiple:e[0].multiple||!1,excludeAcceptAllOption:e[0].excludeAcceptAllOption||!1}),t=await Promise.all(r.map(k));return e[0].multiple?t:t[0]},A={__proto__:null,default:_};function m(e){function n(r){if(Object(r)!==r)return Promise.reject(new TypeError(r+" is not an object."));var t=r.done;return Promise.resolve(r.value).then(function(o){return{value:o,done:t}})}return m=function(r){this.s=r,this.n=r.next},m.prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(r){var t=this.s.return;return t===void 0?Promise.resolve({value:r,done:!0}):n(t.apply(this.s,arguments))},throw:function(r){var t=this.s.return;return t===void 0?Promise.reject(r):n(t.apply(this.s,arguments))}},new m(e)}const h=async(e,n,r=e.name,t)=>{const o=[],a=[];var i,s=!1,c=!1;try{for(var u,p=function(l){var d,y,f,w=2;for(typeof Symbol<"u"&&(y=Symbol.asyncIterator,f=Symbol.iterator);w--;){if(y&&(d=l[y])!=null)return d.call(l);if(f&&(d=l[f])!=null)return new m(d.call(l));y="@@asyncIterator",f="@@iterator"}throw new TypeError("Object is not async iterable")}(e.values());s=!(u=await p.next()).done;s=!1){const l=u.value,d=`${r}/${l.name}`;l.kind==="file"?a.push(l.getFile().then(y=>(y.directoryHandle=e,y.handle=l,Object.defineProperty(y,"webkitRelativePath",{configurable:!0,enumerable:!0,get:()=>d})))):l.kind!=="directory"||!n||t&&t(l)||o.push(h(l,n,d,t))}}catch(l){c=!0,i=l}finally{try{s&&p.return!=null&&await p.return()}finally{if(c)throw i}}return[...(await Promise.all(o)).flat(),...await Promise.all(a)]};var L=async(e={})=>{e.recursive=e.recursive||!1,e.mode=e.mode||"read";const n=await window.showDirectoryPicker({id:e.id,startIn:e.startIn,mode:e.mode});return(await(await n.values()).next()).done?[n]:h(n,e.recursive,void 0,e.skipDirectory)},O={__proto__:null,default:L},E=async(e,n=[{}],r=null,t=!1,o=null)=>{Array.isArray(n)||(n=[n]),n[0].fileName=n[0].fileName||"Untitled";const a=[];let i=null;if(e instanceof Blob&&e.type?i=e.type:e.headers&&e.headers.get("content-type")&&(i=e.headers.get("content-type")),n.forEach((u,p)=>{a[p]={description:u.description||"Files",accept:{}},u.mimeTypes?(p===0&&i&&u.mimeTypes.push(i),u.mimeTypes.map(l=>{a[p].accept[l]=u.extensions||[]})):i?a[p].accept[i]=u.extensions||[]:a[p].accept["*/*"]=u.extensions||[]}),r)try{await r.getFile()}catch(u){if(r=null,t)throw u}const s=r||await window.showSaveFilePicker({suggestedName:n[0].fileName,id:n[0].id,startIn:n[0].startIn,types:a,excludeAcceptAllOption:n[0].excludeAcceptAllOption||!1});!r&&o&&o(s);const c=await s.createWritable();return"stream"in e?(await e.stream().pipeTo(c),s):"body"in e?(await e.body.pipeTo(c),s):(await c.write(await e),await c.close(),s)},x={__proto__:null,default:E},S=async(e=[{}])=>(Array.isArray(e)||(e=[e]),new Promise((n,r)=>{const t=document.createElement("input");t.type="file";const o=[...e.map(c=>c.mimeTypes||[]),...e.map(c=>c.extensions||[])].join();t.multiple=e[0].multiple||!1,t.accept=o||"",t.style.display="none",document.body.append(t);const a=c=>{typeof i=="function"&&i(),n(c)},i=e[0].legacySetup&&e[0].legacySetup(a,()=>i(r),t),s=()=>{window.removeEventListener("focus",s),t.remove()};t.addEventListener("click",()=>{window.addEventListener("focus",s)}),t.addEventListener("change",()=>{window.removeEventListener("focus",s),t.remove(),a(t.multiple?Array.from(t.files):t.files[0])}),"showPicker"in HTMLInputElement.prototype?t.showPicker():t.click()})),T={__proto__:null,default:S},I=async(e=[{}])=>(Array.isArray(e)||(e=[e]),e[0].recursive=e[0].recursive||!1,new Promise((n,r)=>{const t=document.createElement("input");t.type="file",t.webkitdirectory=!0;const o=i=>{typeof a=="function"&&a(),n(i)},a=e[0].legacySetup&&e[0].legacySetup(o,()=>a(r),t);t.addEventListener("change",()=>{let i=Array.from(t.files);e[0].recursive?e[0].recursive&&e[0].skipDirectory&&(i=i.filter(s=>s.webkitRelativePath.split("/").every(c=>!e[0].skipDirectory({name:c,kind:"directory"})))):i=i.filter(s=>s.webkitRelativePath.split("/").length===2),o(i)}),"showPicker"in HTMLInputElement.prototype?t.showPicker():t.click()})),R={__proto__:null,default:I},j=async(e,n={})=>{Array.isArray(n)&&(n=n[0]);const r=document.createElement("a");let t=e;"body"in e&&(t=await async function(i,s){const c=i.getReader(),u=new ReadableStream({start:d=>async function y(){return c.read().then(({done:f,value:w})=>{if(!f)return d.enqueue(w),y();d.close()})}()}),p=new Response(u),l=await p.blob();return c.releaseLock(),new Blob([l],{type:s})}(e.body,e.headers.get("content-type"))),r.download=n.fileName||"Untitled",r.href=URL.createObjectURL(await t);const o=()=>{typeof a=="function"&&a()},a=n.legacySetup&&n.legacySetup(o,()=>a(),r);return r.addEventListener("click",()=>{setTimeout(()=>URL.revokeObjectURL(r.href),3e4),o()}),r.click(),null},F={__proto__:null,default:j};export{M as directoryOpen,I as directoryOpenLegacy,L as directoryOpenModern,U as fileOpen,S as fileOpenLegacy,_ as fileOpenModern,N as fileSave,j as fileSaveLegacy,E as fileSaveModern,v as supported};
